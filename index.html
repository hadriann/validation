<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Form validation</title>
    <meta charset="utf-8" />
    <style>
      form[data-submitted] input {
        border-color: dodgerblue;
      }

      form[data-submitted] :invalid {
        border-color: tomato;
      }
    </style>
  </head>

  <body>
    <form novalidate onsubmit="onSubmit(event)">
      <p>
        <label for="fullname">Name:</label>
        <br />
        <input
          id="fullname"
          name="fullname"
          type="text"
          required
          minlength="3"
          maxlength="10"
          placeholder="First and last name"
        /><br />
        <output for="name" hidden></output>
      </p>

      <p>
        <label for="url">Website:</label>
        <br />
        <input
          id="url"
          name="url"
          type="url"
          required
          pattern="^[^<>]*$"
          placeholder="Absolute URL"
        /><br />
        <output for="url" hidden></output>
      </p>

      <p>
        <label for="team">Team:</label>
        <br />
        <select id="team" name="team">
          <option>Team 1</option>
          <option>Team 2</option>
          <option>Team 3</option>
          <option>Team 4</option>
        </select>
      </p>

      <p>
        <button name="mode" value="test">Send</button>
      </p>
    </form>

    <script type="module">
      import { init } from "./validation.js";

      const form = document.querySelector("form");
      init(form);
    </script>

    <script>
      function onSubmit(event) {
        event.preventDefault();
        const { target: form } = event;

        if (form.checkValidity() && isValid(form)) {
          const fd = new FormData(form);
          const data = Object.fromEntries(fd);
          console.log(111, data);
        }
      }

      function isValid(form) {
        if (!["aaa", "bbb", "ccc"].includes(form.elements.fullname.value)) {
          console.log(22, form.elements.fullname.value);
          form.elements.fullname.setCustomValidity("The value is unacceptable");
          form.checkValidity();
        }
      }
    </script>
  </body>
</html>
